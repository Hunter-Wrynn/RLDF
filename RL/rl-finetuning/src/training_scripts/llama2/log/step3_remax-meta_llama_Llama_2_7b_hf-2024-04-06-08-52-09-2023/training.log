nohup: ignoring input
[2024-04-06 08:52:11,595] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-04-06 08:52:13,130] [WARNING] [runner.py:203:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2024-04-06 08:52:13,130] [INFO] [runner.py:570:main] cmd = /home/student2021/anaconda3/envs/llm/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMSwgMiwgM119 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None main.py --algo remax --data_path age_bias --data_output_path /tmp/data_files/llama2 --data_split 0,0,1 --actor_model_name_or_path /home/student2021/srcao/export-model/llama2_7b_sft --reward_model_name_or_path /home/student2021/srcao/export-model/llama2_7b_rm --num_padding_at_beginning 0 --per_device_generation_batch_size 1 --per_device_training_batch_size 1 --per_device_eval_batch_size 1 --generation_batches 1 --ppo_epochs 1 --max_answer_seq_len 512 --max_prompt_seq_len 1024 --actor_learning_rate 1e-6 --actor_weight_decay 0.1 --num_train_epochs 1 --lr_scheduler_type cosine --gradient_accumulation_steps 1 --actor_gradient_checkpointing --disable_actor_dropout --disable_reward_dropout --num_warmup_steps 0 --kl_ctl 0.05 --gamma 0.99 --deepspeed --offload --offload_reward_model --offload_reference_model --actor_bf16 --reward_bf16 --seed 2023 --actor_zero_stage 2 --reward_zero_stage 3 --reference_zero_stage 3 --enable_hybrid_engine --output_dir ./log/step3_remax-meta_llama_Llama_2_7b_hf-2024-04-06-08-52-09-2023 --enable_tensorboard --print_answers --save_answers --save_at_final
[2024-04-06 08:52:14,856] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-04-06 08:52:16,373] [INFO] [launch.py:145:main] WORLD INFO DICT: {'localhost': [0, 1, 2, 3]}
[2024-04-06 08:52:16,374] [INFO] [launch.py:151:main] nnodes=1, num_local_procs=4, node_rank=0
[2024-04-06 08:52:16,374] [INFO] [launch.py:162:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1, 2, 3]})
[2024-04-06 08:52:16,374] [INFO] [launch.py:163:main] dist_world_size=4
[2024-04-06 08:52:16,374] [INFO] [launch.py:165:main] Setting CUDA_VISIBLE_DEVICES=0,1,2,3
/home/student2021/anaconda3/envs/llm/bin/python: can't open file '/home/student2021/srcao/ReMax-master/step3_rlhf_finetuning/training_scripts/llama2/main.py': [Errno 2] No such file or directory
/home/student2021/anaconda3/envs/llm/bin/python: can't open file '/home/student2021/srcao/ReMax-master/step3_rlhf_finetuning/training_scripts/llama2/main.py': [Errno 2] No such file or directory
/home/student2021/anaconda3/envs/llm/bin/python: can't open file '/home/student2021/srcao/ReMax-master/step3_rlhf_finetuning/training_scripts/llama2/main.py': [Errno 2] No such file or directory
/home/student2021/anaconda3/envs/llm/bin/python: can't open file '/home/student2021/srcao/ReMax-master/step3_rlhf_finetuning/training_scripts/llama2/main.py': [Errno 2] No such file or directory
[2024-04-06 08:52:17,378] [INFO] [launch.py:315:sigkill_handler] Killing subprocess 13461
[2024-04-06 08:52:17,378] [INFO] [launch.py:315:sigkill_handler] Killing subprocess 13462
[2024-04-06 08:52:17,397] [INFO] [launch.py:315:sigkill_handler] Killing subprocess 13463
[2024-04-06 08:52:17,407] [INFO] [launch.py:315:sigkill_handler] Killing subprocess 13464
[2024-04-06 08:52:17,415] [ERROR] [launch.py:321:sigkill_handler] ['/home/student2021/anaconda3/envs/llm/bin/python', '-u', 'main.py', '--local_rank=3', '--algo', 'remax', '--data_path', 'age_bias', '--data_output_path', '/tmp/data_files/llama2', '--data_split', '0,0,1', '--actor_model_name_or_path', '/home/student2021/srcao/export-model/llama2_7b_sft', '--reward_model_name_or_path', '/home/student2021/srcao/export-model/llama2_7b_rm', '--num_padding_at_beginning', '0', '--per_device_generation_batch_size', '1', '--per_device_training_batch_size', '1', '--per_device_eval_batch_size', '1', '--generation_batches', '1', '--ppo_epochs', '1', '--max_answer_seq_len', '512', '--max_prompt_seq_len', '1024', '--actor_learning_rate', '1e-6', '--actor_weight_decay', '0.1', '--num_train_epochs', '1', '--lr_scheduler_type', 'cosine', '--gradient_accumulation_steps', '1', '--actor_gradient_checkpointing', '--disable_actor_dropout', '--disable_reward_dropout', '--num_warmup_steps', '0', '--kl_ctl', '0.05', '--gamma', '0.99', '--deepspeed', '--offload', '--offload_reward_model', '--offload_reference_model', '--actor_bf16', '--reward_bf16', '--seed', '2023', '--actor_zero_stage', '2', '--reward_zero_stage', '3', '--reference_zero_stage', '3', '--enable_hybrid_engine', '--output_dir', './log/step3_remax-meta_llama_Llama_2_7b_hf-2024-04-06-08-52-09-2023', '--enable_tensorboard', '--print_answers', '--save_answers', '--save_at_final'] exits with return code = 2
